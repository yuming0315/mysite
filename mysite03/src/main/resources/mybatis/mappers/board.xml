<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="board">

	<select id="findByPageAndKeyWord" parameterType="map"
		resultType="boardvo">
		<choose>
			<when test='"".equals(kwdVo.kwd) or kwdVo.kwd == null'>		
		<![CDATA[
            select a.no no, name,title,hit,a.reg_date regDate,
            g_no, o_no, depth,user_no
             from board a join user b
             on a.user_no = b.no
             order by a.no desc
             limit ${pager.limit }
   ]]>
			</when>
			<otherwise>
			<![CDATA[
            select a.no no,name,title,hit,a.reg_date regDate,
            g_no, o_no, depth,user_no
             from board a join user b
             on a.user_no = b.no
             where ${kwdVo.kwdOption} like '%${kwdVo.kwd }%'
             order by a.no desc
             limit ${pager.limit }
   ]]>
			</otherwise>
		</choose>

	</select>
	<!-- 위에 keyword는 넘겨줄 때 문자열에 % 붙여서 넘기기 아니면 위의방식 limit #{} 계산못함 계산 해서 넘겨줘야함 -->

	<select id="getTotalCount" parameterType="kwdvo"
		resultType="long">
		<choose>
			<when test='kwd == null or kwd.equals("")'>
			<![CDATA[
			select count(*)
			 from board
			 	]]>
			</when>
			<otherwise>
		<![CDATA[
			select count(*)
			 from board a join user b
			 on a.user_no = b.no
			 where ${kwdOption } like '%${kwd }%'
			 		]]>
			</otherwise>
		</choose>
	</select>
</mapper>
